<html lang="en">
<head>
<title>Guest Wireless Portal</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <style>
      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    </style>
</head>

<!-- Bringing in jQuery for a little button clicking later -->
<script src="jquery.min.js"></script>

<!-- This first script section is for authenticating with Ruckus' Hotspot service -->
<script type="text/javascript">
function get_param(name)
{
if (location.href.indexOf("?") >= 0) {
var query=location.href.split("?")[1];
var params=query.split("&");
for (var i = 0; i < params.length; i ++) {
value_pair=params[i].split("=");
if (value_pair[0] == name)
return unescape(value_pair[1]);
}
}
return "";
}
</script>

<!-- This scripting piece allows us to submit our emails WITHOUT reloading the page, we need to talk to Ruckus and our DB in one submission -->
<script type="text/javascript">
	$(document).ready( function () {
		$("#form1").submit( function () {
			var formdata = $(this).serialize();
			$.ajax({
			    type: "POST",
			    url: "submit.php",
			    data: formdata
			 });
			return false;
		});
	});
</script>

<body class="text-center">
<h1 class="h3 mb-3 font-weight-normal">Sign in Below for Free Wifi</h1>
<form id="form1">
Enter Your Email Address:<br>
<input id="emailField" type="email" name="emails"><br><br>
<input type="submit" name="Submit" id="submitbutton" class="btn btn-lg btn-primary" value="Connect" disabled>
</form>

<!-- Only allow emails to be submitted -->
<script>
const form1 = document.getElementById('form1');
const emailField = document.getElementById('emailField');
const submitbutton = document.getElementById('submitbutton');
  
emailField.addEventListener('keyup', function (event) {
  isValidEmail = emailField.checkValidity();
  
  if ( isValidEmail ) {
    submitbutton.disabled = false;
  } else {
    submitbutton.disabled = true;
  }
});
  
submitbutton.addEventListener('click', function (event) {
  form1.submit();
});
</script>

<!-- Authenticate with Ruckus Hotspot service -->
<script type="text/javascript">
document.write('<form method=POST action="http://' + get_param("sip") + ':9997/login" id="form2">');
</script>
<input type="hidden" name="username" value="user">
<input type="hidden" name="password" value="user">
</form>

<!-- Submit the above form without using a second submit button -->
<script>
 $("#submitbutton").on("click", function()
{
   $("#form2").submit();
 });
</script>

</body>
</html>
